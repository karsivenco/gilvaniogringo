<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WhatsApp - Painel do Gringo</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

  <!-- Header -->
  <header class="flex justify-between items-center bg-[#09679c] text-white p-4 shadow-md">
    <div class="flex items-center gap-3">
      <img src="img/logo.png" alt="Logo Gringo" class="h-10 w-auto" />
      <h1 class="text-xl font-bold">Painel do Gringo</h1>
    </div>
    <nav id="menuLinks" class="flex items-center gap-3"></nav>
  </header>

  <!-- Área de mensagens -->
  <main class="flex-1 p-4 overflow-y-auto">
    <div id="chat" class="space-y-3"></div>
  </main>

  <!-- Campo de envio -->
  <footer class="bg-white p-4 flex border-t">
    <input id="mensagem" type="text" placeholder="Digite sua mensagem..." class="flex-1 border rounded px-3 py-2">
    <button onclick="enviarMensagem()" class="bg-[#09679c] text-white px-4 py-2 ml-2 rounded hover:bg-[#074d6b]">
      Enviar
    </button>
  </footer>

  <script>
    // Simulação de autenticação
    const usuarioLogado = localStorage.getItem("usuario") || "gilvaniogringo"; // substitua pela lógica real

    // Montar menu dinamicamente
    const menu = document.getElementById("menuLinks");
    menu.innerHTML = `
      <a href="whatsapp.html" class="bg-[#09679c] border border-white px-3 py-2 rounded hover:bg-[#074d6b] transition flex items-center gap-1">
        <i class="fab fa-whatsapp"></i> WhatsApp
      </a>
      <a href="nova-postagem.html" class="bg-[#09679c] border border-white px-3 py-2 rounded hover:bg-[#074d6b] transition flex items-center gap-1">
        <i class="fas fa-plus"></i> Nova Postagem
      </a>
      <a href="ultimas-noticias.html" class="bg-[#09679c] border border-white px-3 py-2 rounded hover:bg-[#074d6b] transition flex items-center gap-1">
        <i class="fas fa-newspaper"></i> Últimas Notícias
      </a>
      <a href="perfil.html" class="bg-[#09679c] border border-white px-3 py-2 rounded hover:bg-[#074d6b] transition flex items-center gap-1">
        <i class="fas fa-user"></i> Perfil
      </a>
      ${usuarioLogado === "gilvaniogringo" ? `
        <a href="dashboard.html" class="bg-[#053646] px-3 py-2 rounded hover:bg-[#032d39] transition flex items-center gap-1">
          <i class="fas fa-chart-line"></i> Dashboard
        </a>
      ` : ""}
      <button onclick="logout()" class="bg-[#053646] px-3 py-2 rounded hover:bg-[#032d39] transition flex items-center gap-1">
        <i class="fas fa-sign-out-alt"></i> Sair
      </button>
    `;

    function logout() {
      localStorage.removeItem("usuario");
      window.location.href = "index.html";
    }

    // Integração WhatsApp API (configurar com dados reais)
    const WHATSAPP_API_URL = "https://graph.facebook.com/v20.0/SEU_NUMERO_ID/messages";
    const WHATSAPP_TOKEN = "SEU_TOKEN_DE_ACESSO";
    const NUMERO_DESTINO = "55SEUNUMERO";

    function exibirMensagem(texto, tipo) {
      const div = document.createElement("div");
      div.className = tipo === "enviada" ? "text-right" : "text-left";
      div.innerHTML = `
        <span class="inline-block px-3 py-2 rounded-lg ${tipo === "enviada" ? "bg-[#09679c] text-white" : "bg-gray-200"}">
          ${texto}
        </span>
      `;
      document.getElementById("chat").appendChild(div);
      document.getElementById("chat").scrollTop = document.getElementById("chat").scrollHeight;
    }

    async function enviarMensagem() {
      const mensagem = document.getElementById("mensagem").value.trim();
      if (!mensagem) return;

      exibirMensagem(mensagem, "enviada");
      document.getElementById("mensagem").value = "";

      try {
        const response = await fetch(WHATSAPP_API_URL, {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${WHATSAPP_TOKEN}`,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            messaging_product: "whatsapp",
            to: NUMERO_DESTINO,
            type: "text",
            text: { body: mensagem }
          })
        });

        if (!response.ok) {
          console.error("Erro ao enviar mensagem:", await response.text());
          alert("Não foi possível enviar a mensagem. Verifique o token e número.");
        }
      } catch (error) {
        console.error("Erro na integração:", error);
      }
    }
  </script>

</body>
</html>
